// TODO: lock movement when popup is shown
//lock_movement()